## Керування процесами-транзакціями в базах даних

### 2.1 Теоретичне завдання зі створення історій виконання транзакцій

#### 2.1.1 Створити історію квазіпаралельного успішного виконання транзакцій для
протоколу 1-го ступеня блокування.
TAsk:
T1= W[M] W[K] C1
T2= R[M] R[K] W[M] C2
T3= W[B] R[K] W[M] C3

H1(T1,T2,T3)=X1[M], W1[M], R2[M], X3[B], W3[B], X1[K], W1[K], C1, U1 R1[K], R1[K], X2[M] W2[M], X3[M]-wait, C2, U2, X3[M], W2[M], C3, U3.
Описати таблицю блокування транзакцій до моменту першої фіксації змін однієї з
транзакцій у вигляді масиву на мові програмування С.

:char* lock_table[][3] = {{ "M", "X1", "" },{ "B", "X3", "" },{ "K", "X1", "" }};
#### 2.1.2 Для створеної історії з попереднього завдання визначити наявність Deadlock-
стану транзакції, створивши граф очікування транзакцій, та зробити відповідний висновок.

Представити граф у вигляді масиву на мові програмування С.

int wait[ ][ ] = { {3, 2} };
Висновок:немає циклу dead_lock стану теж немає 

#### 2.1.3 Створити історію квазіпаралельного успішного виконання транзакцій для
протоколу 2-го ступеня блокування.
Описати таблицю блокування транзакцій до моменту першої фіксації змін однієї з
транзакцій у вигляді масиву на мові програмування С.


H2(T1,T2,T3)= X1[M], W1[M], S2[M]-wait, X3[B], W3[B], X1[K], W1[K], C1, U1, S2[K]-wait, S3[K]-wait, X2[M]-wait, X3[M]-wait, U2[M], X2[M], W[M], U2[k], R[K] C2, S3[K], R[K], X3[M], W[M],
, C3
:char* lock_table[][3] = {{ "M", "X1", "S2" },{ "B", "X3", "" },{ "K", "X1", "S2,S3" },{ "M", "s2", "X2" }};


2.1.4

int wait[ ][ ] = { {2, 1},{2 , 1},{3,1},{2,2} };
Висновок:dead_lock є .


### 2.2 Налаштування бази даних

![image](https://github.com/Phantom63174/lab3/assets/127674749/1190a5de-da21-4ae1-a8b0-037fa43c6635)

рис 1 до завдання 2.2.1 Встановити з’єднання з БД, назва якої співпадає з іменем вашого користувача
в ОС Linux, використовуючи користувача СКБД за таким же іменем.

![image](https://github.com/Phantom63174/lab3/assets/127674749/dd4b821b-d677-46da-970c-61134dcd4f9d)

рис 2 до завдання 2.2.2 Виконати команди отримання імені поточного користувача СКБД та назви БД.

![image](https://github.com/Phantom63174/lab3/assets/127674749/72cdff86-c98a-477d-af25-b36e838022c4)

рис 3 до завдання 2.2.3 У відповідності із варіантом з таблиці 16 створити реляційну таблицю.

![image](https://github.com/Phantom63174/lab3/assets/127674749/7058d53d-6a2a-4399-bde2-2929e484d28b)

рис 4 до завдання 2.2.4 У відповідності із варіантом з таблиці 16 додати рядок в реляційну таблицю.
![image](https://github.com/Phantom63174/lab3/assets/127674749/c18412bb-6602-4f12-844f-1132fd575b47)

рис 5 до завдання 2.2.5 Створити ще одну операцію внесення рядка в таблицю, який буде відрізнятися
значеннями всіх змінних (стовпчиків) від прикладу з варіанту, а одна із змінних повинна
враховувати значення із транслітерацією вашого прізвища.

![image](https://github.com/Phantom63174/lab3/assets/127674749/4d2d397b-eb9d-44e8-9317-394b7c105105)

рис 6 до завдання 2.2.6 Переглянути зміст таблиці, враховуючи всі стовпчики всіх рядків таблиці.


### 2.3 Керування квазіпаралельним виконанням транзакцій з використанням команд блокування

![image](https://github.com/Phantom63174/lab3/assets/127674749/093124cf-91fd-4ed2-a0ff-087e15198bd2)

Рис. 7 - фрагмент екрану з рiшення "2.3.1 Створити файл з назвою за шаблоном «ваше прізвище_transaction_lock_1.sql»,
наприклад, blazhko_transaction_lock_1.sql, та додати до нього операції двох транзакцій,
кожна з яких повинна включати наступні операції:
- операція блокування для протоколу 1-го ступеня блокування;
- операція читання всіх стовпчиків першого рядку таблиці;
- операція зміни значення другого стовпчика таблиці у першому рядку;
- повторна операція читання всіх стовпчиків першого рядку таблиці;
- операція фіксації всіх виконаних операцій."


![image](https://github.com/Phantom63174/lab3/assets/127674749/3d35bb60-7238-4b15-9686-212a19ff9322)

Рис. 8 - фрагмент екрану з рiшення "2.3.2 У двох псевдотерміналах виконати операції транзакцій при їх
квазіпаралельному режимі роботи за умови, що одна з транзакція стартує першою."


![image](https://github.com/Phantom63174/lab3/assets/127674749/4cd0a033-0905-4dca-a3d8-e3cc5108d832)

Рис. 9 - фрагмент екрану з рiшення "2.3.3 Повторити роботу транзакцій, але у першій транзакції замість операції
фіксації виконати операцію відміни всіх операцій транзакції."


![image](https://github.com/Phantom63174/lab3/assets/127674749/57065b82-1dc9-46ed-938e-2cbde2e25f65)64c)

Рис. 10 - фрагмент екрану з рiшення "2.3.4 Створити файл з назвою за шаблоном «ваше прізвище_transaction_lock_2.sql»,
наприклад, blazhko_transaction_lock_2.sql, зі змістом файлу, створеного у пункті 2.3.1, але
вже враховуючи протокол 2-го ступеня блокування."


![image](https://github.com/Phantom63174/lab3/assets/127674749/59a8b848-8723-4af9-a84f-cac13bd8fc4a)

Рис. 11 - фрагмент екрану з рiшення "2.3.5 Повторити роботу транзакцій з використанням протоколу 2-го ступеня
блокування, але з додатковим параметром NOWAIT."



### 2.4 Керування квазіпаралельним виконанням транзакцій при наявності Deadlock-станів.


![image](https://github.com/Phantom63174/lab3/assets/127674749/e9023dfe-97f4-4e13-9bff-61ab50d1bd58)

Рис. 12 - фрагмент екрану з рiшення "2.4.1 Створити файл з назвою за шаблоном «ваше прізвище_deadlock.sql»,
наприклад, blazhko_deadlock.sql, зі змістом файлу, створеного у пункті 2.3.1, але вже
модифікованого так, щоб транзакції призводили до Deadlock-стану."


![image](https://github.com/Phantom63174/lab3/assets/127674749/a5181b00-ef95-4bc7-8726-ba26dafe2d5b)

### Висновок: ми розробили програму, яка створює дві транзакції. Проте під час їх виконання виникла ситуація, відома як "deadlock" . Це означає, що коли обидва процеси очікують звільнення ресурсів, які потрібні один одному, вони блокуються взаємно. У такій ситуації ніякий з процесів не може продовжити свою роботу, доки не отримає доступ до ресурсів, які зараз заблоковані іншими процесами.

Рис. 13 - фрагмент екрану з рiшення "2.4.2 Виконати модифіковані транзакції. Проаналізувати реакцію СКБД на операцію зміни значення стовпчика для транзакції, яка виконувалася пізніше (призвела до Deadlock-стану), та надати висновки за результатами аналізу з урахуванням ідентифікаторів процесів та номерів транзакцій."
